<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" dir="{{ default `ltr` .Language.LanguageDirection }}">
    <head>
        {{- partial "head/head.html" . -}}
        {{- block "head" . -}}{{ end }}
    </head>
    <body class="{{ block `body-class` . }}{{ end }}">
        {{- partial "head/colorScheme" . -}}

        {{/* The container is wider when there's any activated widget */}}
        {{- $hasWidget := false -}}
        {{- range .Site.Params.widgets -}}
            {{- if gt (len .) 0 -}}
                {{ $hasWidget = true -}}
            {{- end -}}
        {{- end -}}
        
        {{- /* 侧边栏切换按钮 - 放在容器外部，确保始终可见 */ -}}
        {{- /* 左侧按钮：调整位置避免遮挡导航栏 */ -}}
        <button class="sidebar-toggle sidebar-toggle-left" type="button" id="toggle-left-sidebar" aria-label="切换左侧边栏" title="收起/展开左侧边栏">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <polyline points="15 6 9 12 15 18" />
            </svg>
        </button>
        
        {{- /* 右侧按钮：只在有目录的文章页显示 */ -}}
        {{- $isArticlePage := eq .Kind "page" -}}
        {{- $hasTOC := false -}}
        {{- if $isArticlePage -}}
            {{- $TOCManuallyDisabled := eq .Params.toc false -}}
            {{- $TOCWidgetEnabled := false -}}
            {{- range .Site.Params.widgets.page -}}
                {{- if eq .type "toc" -}}
                    {{- $TOCWidgetEnabled = true -}}
                {{- end -}}
            {{- end -}}
            {{- $TOCEnabled := and (not $TOCManuallyDisabled) $TOCWidgetEnabled -}}
            {{- $hasTOC = and $TOCEnabled (ge (len .TableOfContents) 100) -}}
        {{- end -}}
        {{- if $hasTOC -}}
        <button class="sidebar-toggle sidebar-toggle-right" type="button" id="toggle-right-sidebar" aria-label="切换右侧边栏" title="收起/展开右侧边栏">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <polyline points="9 6 15 12 9 18" />
            </svg>
        </button>
        {{- end -}}
        
        <div class="container main-container flex on-phone--column {{ if $hasWidget }}extended{{ else }}compact{{ end }}">
            {{- block "left-sidebar" . -}}
                {{ partial "sidebar/left.html" . }}
            {{- end -}}
            {{- block "right-sidebar" . -}}{{ end }}
            <main class="main full-width">
                {{- block "main" . }}{{- end }}
            </main>
        </div>
        {{ partial "footer/include.html" . }}
    </body>
</html>
